{% extends "base.html" %}
{% block title %}Forgot Password{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{{ url_for('static', path='css/auth.css') }}?v={{ static_version }}"/>
{% endblock %}

{% block content %}
<div class="forgot-password-container">
  <h3>Forgot Password</h3>

  {# Flash messages (success / error) #}
  {% if flashes and flashes|length %}
    <div class="flash-stack">
      {% for f in flashes %}
        <div class="alert alert-{{ f.category }}">{{ f.message }}</div>
      {% endfor %}
    </div>
  {% endif %}

  <p id="errorMsg" class="error" aria-live="polite"></p>

  {# NOTE: real form post target + hidden CSRF #}
  <form id="forgotPasswordForm" method="POST" action="/auth/link-forgot-password" novalidate>
    <input type="hidden" name="csrf_token" value="{{ request.cookies.get('XSRF-TOKEN','') }}"/>

    <!-- Username Input -->
    <div class="floating-field">
      <input
        type="text"
        id="login_id"
        name="login_id"
        placeholder=" "
        required
        autocomplete="username"
      />
      <label for="login_id">Enter your login id</label>
    </div>
    <small class="input-error" id="login_idError"></small>

    <!-- Email Input -->
    <div class="floating-field">
      <input
        type="email"
        id="email"
        name="email"
        placeholder=" "
        required
        autocomplete="email"
      />
      <label for="email">Enter your email</label>
    </div>
    <small class="input-error" id="emailError"></small>

    <button type="submit" id="forgotPasswordBtn" class="btn-primary">Send Reset Link</button>
  </form>

  <p class="auth-footer-text">
    Remembered your password? <a href="/login">Login Here</a>
  </p>
</div>
{% endblock %}

{% block extra_js %}
{# Keep your script â€” it enhances UX, but the form works without JS too #}
<script nonce="{{ request.state.csp_nonce }}" src="{{ url_for('static', path='js/auth/forgot_password.js') }}?v={{ static_version }}" defer></script>
{% endblock %}